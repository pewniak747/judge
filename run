#!/bin/bash

JUDGE=bin/judge
COMPILE=bin/compile
CLEANUP=bin/cleanup
SOLUTIONS_DIR=solutions

if [[ $PROBLEMS == "" ]]; then
  PROBLEMS=$@
fi

if [[ $PROBLEMS == "" ]]; then
  PROBLEMS=`ls -v -m1 $SOLUTIONS_DIR`
fi

for problem in $PROBLEMS; do
  $COMPILE $SOLUTIONS_DIR/$problem/$problem.cpp $problem
  if [[ $? == 0 ]]; then
    $JUDGE $problem
  else
    echo
    $CLEANUP
  fi
done
